<!DOCTYPE html>
<html>
<head>
    <title>Kuvat videoksi</title>
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
    <style>
        body { font-family: Arial; text-align: center; margin: 20px; }
        button { padding: 10px 20px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>Lataa kuvat ja luo video</h1>
    <input type="file" id="imageUpload" accept="image/*" multiple>
    <button onclick="createVideo()">Luo video</button>
    <video id="outputVideo" controls></video>
    <script>
        const { createFFmpeg, fetchFile } = FFmpeg;
        const ffmpeg = createFFmpeg({ log: true });

        async function createVideo() {
            const images = document.getElementById('imageUpload').files;
            if (!images.length) { alert("Lataa kuvia!"); return; }
            if (!ffmpeg.isLoaded()) await ffmpeg.load();
            for (let i = 0; i < images.length; i++) {
                ffmpeg.FS('writeFile', `image${i}.jpg`, await fetchFile(images[i]));
            }
            await ffmpeg.run('-framerate', '1', '-i', 'image%d.jpg', '-c:v', 'libx264', '-r', '30', '-pix_fmt', 'yuv420p', 'output.mp4');
            const data = ffmpeg.FS('readFile', 'output.mp4');
            const video = document.getElementById('outputVideo');
            video.src = URL.createObjectURL(new Blob([data.buffer], { type: 'video/mp4' }));
        }
    </script>
</body>
</html>
